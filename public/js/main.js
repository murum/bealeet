var FlashMessage={};FlashMessage.config={messageContainer:$("div#messages-container")},FlashMessage.show=function(e,s){var t=document.createElement("div");t=$(t),t.addClass("alert").addClass("alert-"+s),t.append(e),FlashMessage.config.messageContainer.append(t),t.delay(4e3).fadeOut(1e3)},FlashMessage.success=function(e){FlashMessage.show(e,"success")},FlashMessage.error=function(e){FlashMessage.show(e,"danger")},FlashMessage.info=function(e){FlashMessage.show(e,"info")},window.fbAsyncInit=function(){FB.init({appId:"671187556307321",xfbml:!0,version:"v2.1"})};var Bealeet={};Bealeet.toggle={init:function(){$(".dropdown a.dropdown-toggle").on("click",this.toggleDropdown),$(".dropdown a.dropdown-close").on("click",this.hideDropdown),$("button.user-profile-subheader-games-add-button").on("click",this.toggleAddGameDropdown),$("button.user-profile-skills-add-button").on("click",this.toggleAddSkillDropdown)},toggleDropdown:function(e){e.preventDefault(),$(this).closest(".dropdown").toggleClass("open")},hideDropdown:function(e){e.preventDefault(),$(this).closest(".dropdown").removeClass("open")},toggleAddGameDropdown:function(e){e.preventDefault(),$(this).closest(".user-profile-subheader-games-add").toggleClass("open")},toggleAddSkillDropdown:function(e){e.preventDefault(),$(this).closest(".user-profile-skills-add").toggleClass("open")}},Bealeet.chosen={init:function(){$("div.user-profile-subheader-games-add select.chosen-list").chosen({width:"100%"}).change(this.userChangeGames),$("div.user-profile-skills-add select.chosen-list").chosen({width:"100%"}).change(this.userChangeSkills)},userChangeGames:function(e,s){var t=$(this).closest("form"),a=t.attr("action");$.ajax({url:a,type:"put",dataType:"json",data:s,success:function(e){FlashMessage.success(e.message)},error:function(e){var e=$.parseJSON(e.responseText);e.message?FlashMessage.error(e.message):FlashMessage.error(e.error.message)}})},userChangeSkills:function(e,s){var t=$(this).closest("form"),a=t.attr("action");s.deselected?swal({title:"Are you sure?",text:"When you remove a skill you will also lose all your points for the specific skill.!",type:"warning",showCancelButton:!0,confirmButtonColor:"#45c54b",confirmButtonText:"Yes, remove skill!",cancelButtonText:"Regret",closeOnConfirm:!0,closeOnCancel:!0},function(e){return e?($.ajax({url:a,type:"put",dataType:"json",data:s,success:function(e){FlashMessage.success(e.message)},error:function(e){var e=$.parseJSON(e.responseText);e.message?FlashMessage.error(e.message):FlashMessage.error(e.error.message)}}),void 0):!1}):$.ajax({url:a,type:"put",dataType:"json",data:s,success:function(e){FlashMessage.success(e.message)},error:function(e){var e=$.parseJSON(e.responseText);e.message?FlashMessage.error(e.message):FlashMessage.error(e.error.message)}})}},Bealeet.switcher={init:function(){$("input#user-profile-searching-switcher").on("change",this.userChangeSearchStatus)},userChangeSearchStatus:function(){var e=$(this).closest("form"),s=e.attr("action"),t=$(this).prop("checked");$.ajax({url:s,type:"put",dataType:"json",data:{isSearching:t},success:function(e){FlashMessage.success(e.message)},error:function(e){var e=$.parseJSON(e.responseText);e.message?FlashMessage.error(e.message):FlashMessage.error(e.error.message)}})}},Bealeet.selectpicker={init:function(){$("select.selectpicker").selectpicker(),$("div.user-profile-subheader-games-primary select").selectpicker().on("change",this.userChangePrimaryGame)},userChangePrimaryGame:function(){var e=$(this).closest("form"),s=e.attr("action"),t=$(this).val();$.ajax({url:s,type:"put",dataType:"json",data:{favoriteGameId:t},success:function(e){FlashMessage.success(e.message)},error:function(e){var e=$.parseJSON(e.responseText);e.message?FlashMessage.error(e.message):FlashMessage.error(e.error.message)}})}},Bealeet.skills={init:function(){$(".btn-testify-skill").on("click",this.addSkillPoint)},addSkillPoint:function(){var e=$(this),s=e.closest("form"),t=s.attr("action"),a=e.closest(".user-profile-skills-item"),n=a.data("skill");$.ajax({url:t,type:"post",dataType:"json",data:{skillId:n},success:function(e){s.remove(),a.removeClass("plusable"),a.attr("data-amount",parseInt(a.data("amount"))+1),FlashMessage.success(e.message)},error:function(e){var e=$.parseJSON(e.responseText);e.message?FlashMessage.error(e.message):FlashMessage.error(e.error.message)}})}},Bealeet.findPlayers={init:function(){$("select#filterGames").on("change",this.filterGame)},filterGame:function(){window.location.replace(window.location.origin+"/find/players/"+this.value)}},Bealeet.fadeoutLinks={init:function(){this.main()},main:function(){$("a").click(function(){"_blank"!=$(this).attr("target")&&-1==$(this).attr("href").indexOf("mailto")&&-1==$(this).attr("href").indexOf("#")&&$("div.container").fadeOut(400)})}},Bealeet.conversations={init:function(){this.setConversationsTimes(),$("form.conversation-form textarea").on("keyup",this.sendOnEnterClick)},setConversationsTimes:function(){$.each($("span.conversation__last__time"),function(){var e=moment($(this).data("time")).fromNow();$(this).html(e)})},sendOnEnterClick:function(e){return 13!=e.keyCode||e.shiftKey||$(this).closest("form").submit(),!1}},$(function(){Bealeet.fadeoutLinks.init(),Bealeet.toggle.init(),Bealeet.chosen.init(),Bealeet.selectpicker.init(),Bealeet.switcher.init(),Bealeet.skills.init(),Bealeet.findPlayers.init(),Bealeet.conversations.init(),$(document).ready(function(){$("div.container").animate({opacity:1},400)})});